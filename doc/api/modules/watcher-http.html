<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>watcher-http - watcher.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="watcher.js" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 2.5.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/AbstractConnector.html">AbstractConnector</a></li>
                                <li><a href="../classes/DBConnectionFactory.html">DBConnectionFactory</a></li>
                                <li><a href="../classes/Dictionary.html">Dictionary</a></li>
                                <li><a href="../classes/DictionaryFactory.html">DictionaryFactory</a></li>
                                <li><a href="../classes/EventDispatcher.html">EventDispatcher</a></li>
                                <li><a href="../classes/EventDispatcherFactory.html">EventDispatcherFactory</a></li>
                                <li><a href="../classes/HttpConnector.html">HttpConnector</a></li>
                                <li><a href="../classes/HttpConnectorFactory.html">HttpConnectorFactory</a></li>
                                <li><a href="../classes/Logger.html">Logger</a></li>
                                <li><a href="../classes/OnConnectionResolution.html">OnConnectionResolution</a></li>
                                <li><a href="../classes/OnConnectionResolutionFactory.html">OnConnectionResolutionFactory</a></li>
                                <li><a href="../classes/ResolutionStrategy.html">ResolutionStrategy</a></li>
                                <li><a href="../classes/ResolutionStrategyFactory.html">ResolutionStrategyFactory</a></li>
                                <li><a href="../classes/ResolverEvents.html">ResolverEvents</a></li>
                                <li><a href="../classes/ServiceStatus.html">ServiceStatus</a></li>
                                <li><a href="../classes/SocketConnector.html">SocketConnector</a></li>
                                <li><a href="../classes/SocketConnectorFactory.html">SocketConnectorFactory</a></li>
                                <li><a href="../classes/StatusResolver.html">StatusResolver</a></li>
                                <li><a href="../classes/StatusResolverFactory.html">StatusResolverFactory</a></li>
                                <li><a href="../classes/TransactionalExecutor.html">TransactionalExecutor</a></li>
                                <li><a href="../classes/Validator.html">Validator</a></li>
                                <li><a href="../classes/Watcher.html">Watcher</a></li>
                                <li><a href="../classes/WatcherEvents.html">WatcherEvents</a></li>
                                <li><a href="../classes/WatcherFactory.html">WatcherFactory</a></li>
                                <li><a href="../classes/WatcherHttp.html">WatcherHttp</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/connectors.html">connectors</a></li>
                                <li><a href="../modules/constants.html">constants</a></li>
                                <li><a href="../modules/database.html">database</a></li>
                                <li><a href="../modules/httpServer.html">httpServer</a></li>
                                <li><a href="../modules/logger.html">logger</a></li>
                                <li><a href="../modules/resolvers.html">resolvers</a></li>
                                <li><a href="../modules/utils.html">utils</a></li>
                                <li><a href="../modules/validator.html">validator</a></li>
                                <li><a href="../modules/watcher.html">watcher</a></li>
                                <li><a href="../modules/watcher-http.html">watcher-http</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1>watcher-http Module</h1>
<div class="box clearfix meta">


        <div class="foundat">
            Defined in: <a href="../files/src_routes_watcher-http.js.html#l271"><code>src&#x2F;routes&#x2F;watcher-http.js:271</code></a>
        </div>

</div>


<div class="box intro">
    <p>The application&#39;s REST API implementation.</p>
<h3 id="rest-api">REST API</h3>
<p>In case of failure the server returns an object with the following structure:</p>
<pre class="code prettyprint"><code>{
     message: message,   //generic error message
     errors: errors      //array of specific errors
}
</code></pre><h4 id="get-information-for-a-specific-endpoint-">Get information for a specific endpoint.</h4>
<hr>
<ul>
<li><strong>http://<code>&lt;host&gt;</code>:<code>&lt;port&gt;</code>/endpoints/<code>&lt;id&gt;</code></strong> (request method: GET),</li>
<li>parameters:<ul>
<li><strong>id</strong> the endpoint id, it should be one of those defined at endpoints configuration data,</li>
</ul>
</li>
<li>API reference: <strong><a href="../classes/Watcher.html#method_getEndpoint" class="crosslink">getEndpoint</a></strong>.</li>
</ul>
<p><strong>Response on success:</strong></p>
<pre class="code prettyprint"><code>// For a socket communication type
{
     "id": "endpoint-id",            // endpoint id
     "desc": "an endpoint",          // endpoint description
     "status": "up",                 // endpoint status
     "timestamp": 1429860936846,     // the timestamp of the current status
     "since": 1429860926846,         // the timestamp since the last change of status
     "type": "socket",               // connector type
     "host": "localhost",            // endpoint host (applied for &#39;socket&#39; connector)
     "port": 7777,                   // endpoint port (applied for &#39;socket&#39; connector)
     "active": true,                 // whether or not the endpoint is active
     "notify": false                 // whether or not the notification is enabled
}
</code></pre><p><strong>Response on error:</strong></p>
<pre class="code prettyprint"><code>If the endpoint does not exist an error message with http status 422 is send
</code></pre><h4 id="get-information-for-all-registered-endpoints-">Get information for all registered endpoints.</h4>
<hr>
<ul>
<li><strong>http://<code>&lt;host&gt;</code>:<code>&lt;port&gt;</code>/endpoints</strong> (request method: GET).</li>
<li>API reference: <strong><a href="../classes/Watcher.html#method_getEndpoints" class="crosslink">getEndpoints</a></strong>.</li>
</ul>
<p> <strong>Response on success:</strong></p>
<pre class="code prettyprint"><code>An array with the information for all endpoints.
// For a socket and http communication types
[
     {
         "id": "endpoint-1",
         "desc": "endpoint 1",
         "status": "down"
         "timestamp": 1429860936846,
         "since": 1429860926846,
         "type": "socket",
         "host": "localhost",
         "port": 7777,
         "active": true,
         "notify": true
     },
     {
         "id": "endpoint-2",                     // endpoint id
         "desc": "endpoint 2",                   // endpoint description
         "status": "up"                          // endpoint status
         "timestamp": 1429860936846,             // the timestamp of the current status
         "since": 1429860926846,                 // the timestamp since the last change of status
         "type": "http",                         // connector type
         "url": "http://11.222.333.555:3333/",   // endpoint url (applied for &#39;http(s) connector&#39;)
         "active": true,                         // whether or not the endpoint is active
         "notify": false                         // whether or not the notification is enabled
     }
]
</code></pre><p><strong>Response on error:</strong></p>
<pre class="code prettyprint"><code>Generic error message with http status 500
</code></pre><h4 id="add-new-endpoint-">Add new endpoint.</h4>
<hr>
<ul>
<li><strong>http://<code>&lt;host&gt;</code>:<code>&lt;port&gt;</code>/endpoints</strong> (request method POST)</li>
<li>parameters (parameters in <em>[]</em> are optional. when not set, the default values are used - those in parentheses.):<ul>
<li><strong>id</strong> : the endpoint id,</li>
<li><strong>desc</strong> : the endpoint description,</li>
<li><strong>type</strong> : the endpoint type (&#39;socket&#39; or &#39;http&#39;),</li>
<li>[<strong>host</strong>] (localhost): the endpoint host (applied for &#39;socket&#39; communication type),</li>
<li>[<strong>port</strong>] (9999): the endpoint port (applied for &#39;socket&#39; communication type),</li>
<li>[<strong>url</strong>] : the endpoint port (applied for &#39;http&#39; communication type),</li>
<li>[<strong>active</strong>] (true): true/false whether or not to activate the endpoint,</li>
<li>[<strong>notify</strong>] (false): true/false whether or not to enable email notification on erroneous service status</li>
</ul>
</li>
<li>API reference: <strong><a href="../classes/Watcher.html#method_addEndpoint" class="crosslink">addEndpoint</a></strong>.</li>
</ul>
<p> <strong>Response on success:</strong></p>
<pre class="code prettyprint"><code>{
     "id":     "&lt;endpoint id&gt;"         //endpoint id
     "uri":    "&lt;access endpoint uri&gt;" //endpoint uri, e.g. /endpoints/&lt;endpoint id&gt;
     "status": "&lt;endpoint status&gt;"     //endpoint status (e.g. &#39;undetermined&#39;)
}
</code></pre><p><strong>Response on error:</strong></p>
<pre class="code prettyprint"><code>Validation error messages with http status 422
</code></pre><h4 id="remove-an-endpoint-">Remove an endpoint.</h4>
<hr>
<ul>
<li><strong>http://<code>&lt;host&gt;</code>:<code>&lt;port&gt;</code>/endpoints/<code>&lt;id&gt;</code></strong> (request method: DELETE),</li>
<li>parameters:<ul>
<li><strong>id</strong> : the endpoint id</li>
</ul>
</li>
<li>API reference: <strong><a href="../classes/Watcher.html#method_removeEndpoint" class="crosslink">removeEndpoint</a></strong>.</li>
</ul>
<p> <strong>Response on success:</strong></p>
<pre class="code prettyprint"><code>{
     "id": "&lt;endpoint id&gt;"   //removed endpoint id
}
</code></pre><p><strong>Response on error:</strong></p>
<pre class="code prettyprint"><code>If the endpoint does not exist an error message with http status 422 is send
</code></pre><h4 id="activate-deactivate-an-endpoint-">Activate/deactivate an endpoint.</h4>
<hr>
<ul>
<li><strong>http://<code>&lt;host&gt;</code>:<code>&lt;port&gt;</code>/endpoints/<code>&lt;id&gt;</code>/activate</strong> (request method POST),</li>
<li><strong>http://<code>&lt;host&gt;</code>:<code>&lt;port&gt;</code>/endpoints/<code>&lt;id&gt;</code>/activate</strong> (request method DELETE),</li>
<li>parameters:<ul>
<li><strong>id</strong> : the endpoint id,</li>
</ul>
</li>
<li>API reference: <strong><a href="../classes/Watcher.html#method_setEndpointActivationState" class="crosslink">setEndpointActivationState</a></strong>.</li>
</ul>
<p> <strong>Response on success:</strong></p>
<pre class="code prettyprint"><code>{
     "id": "&lt;endpoint id&gt;"           //endpoint id
     "active": "&lt;activation state&gt;"  //activation state
     "status": "&lt;endpoint status&gt;"   //endpoint status
}
</code></pre><p><strong>Response on error:</strong></p>
<pre class="code prettyprint"><code>If the endpoint does not exist an error message with http status 422 is send
</code></pre><h4 id="enable-disable-notification-for-an-endpoint-">Enable/disable notification for an endpoint.</h4>
<hr>
<ul>
<li><strong>http://<code>&lt;host&gt;</code>:<code>&lt;port&gt;</code>/endpoints/<code>&lt;id&gt;</code>/notify</strong> (request method POST),</li>
<li><strong>http://<code>&lt;host&gt;</code>:<code>&lt;port&gt;</code>/endpoints/<code>&lt;id&gt;</code>/notify</strong> (request method DELETE),</li>
<li>parameters:<ul>
<li><strong>id</strong> : the endpoint id,</li>
</ul>
</li>
<li>API reference: <strong><a href="../classes/Watcher.html#method_notifyOnErroneousStatus" class="crosslink">notifyOnErroneousStatus</a></strong>.</li>
</ul>
<p> <strong>Response on success:</strong></p>
<pre class="code prettyprint"><code>{
     "id": "&lt;endpoint id&gt;"               //endpoint id
     "notify": "&lt;notification state&gt;"    //activation state
}
</code></pre><p><strong>Response on error:</strong></p>
<pre class="code prettyprint"><code>If the endpoint does not exist an error message with http status 422 is send
</code></pre><h4 id="get-the-the-unbound-resolution-strategies-">Get the the unbound resolution strategies.</h4>
<hr>
<ul>
<li><strong>http://<code>&lt;host&gt;</code>:<code>&lt;port&gt;</code>/resolution-strategies</strong> (request method GET),</li>
<li>API reference: <strong><a href="../classes/Watcher.html#method_getResolutionStrategies" class="crosslink">getResolutionStrategies</a></strong>.</li>
</ul>
<p> <strong>Response on success:</strong></p>
<pre class="code prettyprint"><code>An array with the unbound resolution strategies:
[
 "&lt;strategy id&gt;"     //the strategy id, e.g.: "on-connection",
 "&lt;strategy id&gt;"     //the strategy id, e.g.: "always-down",
]
</code></pre><p><strong>Response on error:</strong></p>
<pre class="code prettyprint"><code>Generic error message with http status 500
</code></pre><h4 id="get-history-status-">Get history status.</h4>
<hr>
<ul>
<li><strong>http://<code>&lt;host&gt;</code>:<code>&lt;port&gt;</code>//history/endpoints</strong> (request method GET)
<strong>complete history for all endpoints</strong></li>
<li><strong>http://<code>&lt;host&gt;</code>:<code>&lt;port&gt;</code>//history/endpoints/<code>&lt;id&gt;</code></strong> (request method GET)
<strong>complete history for specific endpoint</strong></li>
<li><strong>http://<code>&lt;host&gt;</code>:<code>&lt;port&gt;</code>//history/endpoints/<code>&lt;from&gt;</code>/<code>&lt;to&gt;</code></strong> (request method GET)
<strong>history for specific time period for all endpoints</strong></li>
<li><strong>http://<code>&lt;host&gt;</code>:<code>&lt;port&gt;</code>//history/endpoints/<code>&lt;id&gt;</code>/<code>&lt;from&gt;</code>/<code>&lt;to&gt;</code></strong> (request method GET)
<strong>history for specific time period and specific endpoint</strong></li>
<li>API reference: <strong><a href="../classes/Watcher.html#method_getHistory" class="crosslink">getHistory</a></strong>.</li>
</ul>
<p> <strong>Response on success:</strong></p>
<pre class="code prettyprint"><code>An array with the history status entries:
[
 {
     "endpointId": "&lt;endpoint id&gt;",      //endpoint id
     "timestamp": "&lt;timestamp&gt;",         //timestamp,
     "statusTransition": {
         "from": "&lt;previous status&gt;",    //current endpoint status
         "to": "&lt;current status&gt;"        //previous endpoint status
     }
 },
 {
     "endpointId": "&lt;endpoint id&gt;",
     "timestamp": &lt;timestamp&gt;
     "statusTransition": {
         "from": "&lt;previous status&gt;",
         "to": "&lt;current status&gt;"
     }
 }
]
</code></pre><p><strong>Response on error:</strong></p>
<pre class="code prettyprint"><code>Generic error message with http status 500
</code></pre>
</div>


<div class="yui3-g">
    <div class="yui3-u-1-2">
            <p>This module provides the following classes:</p>

            <ul class="module-classes">
                <li class="module-class">
                    <a href="../classes/WatcherHttp.html">
                        WatcherHttp
                    </a>
                </li>
            </ul>
    </div>

    <div class="yui3-u-1-2">
    </div>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
